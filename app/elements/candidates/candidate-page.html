<link rel="import" href="invite-candidates.html">
<link rel="import" href="candidate-list.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/paper-fab/paper-fab.html">

<dom-module id="candidate-page">
	<style>
		#createActionButton {
			position: fixed;
			right: 2%;
			bottom: 5%;
		}
	</style>
	<template>
		<iron-ajax
			id="getChallengesAjax"
			handle-as="json"
			on-response="onGetChallengesResponse"
			on-error="onError"
			with-credentials="true"
			method="GET">
		</iron-ajax>

		<paper-fab id="createActionButton" on-click="_toggleDialog" icon="create"></paper-fab>
		<invite-candidates id="inviteCandidates" challenges="{{challenges}}"></invite-candidates>
		<candidate-list id="candidateList"></candidate-list>
	</template>
	<script>
		Polymer({
			is: 'candidate-page',
			properties: {
				Address: String,
				challenges: {
					type: Array,
					notify: true
				}
			},
			getChallenges: function () {
				this.$.getChallengesAjax.url = util.build('/companies/' + util.company().Key + '/challenges');
				this.$.getChallengesAjax.generateRequest();
			},
			getCandidates: function () {
				this.$.candidateList.getCandidates();
			},
			onGetChallengesResponse: function (res) {
				this.challenges = res.detail.response;
			},
			onError: function (error) {
				util.error(error);
			},
			_toggleDialog: function () {
				this.$.inviteCandidates.toggle();
			}
		});
	</script>
</dom-module>
